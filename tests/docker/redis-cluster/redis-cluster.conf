# Redis Cluster Node Configuration

# Enable cluster mode
cluster-enabled yes

# Cluster configuration file (auto-generated)
cluster-config-file nodes.conf

# Cluster node timeout in milliseconds
cluster-node-timeout 5000

# Cluster replica validity factor
cluster-replica-validity-factor 10

# Cluster migration barrier
cluster-migration-barrier 1

# Require full coverage
cluster-require-full-coverage yes

# Cluster replica no failover
cluster-replica-no-failover no

# Cluster allow reads when down
cluster-allow-reads-when-down no

# Cluster allow pubsubshard when down
cluster-allow-pubsubshard-when-down yes

# General Redis settings
appendonly yes
appendfsync everysec

# Enable RDB snapshots
save 900 1
save 300 10
save 60 10000

# Memory management
maxmemory 256mb
maxmemory-policy allkeys-lru

# Logging
loglevel notice

# Disable protected mode for local development
protected-mode no

# Bind to all interfaces (for Docker networking)
bind 0.0.0.0

# Performance tuning
tcp-backlog 511
tcp-keepalive 300
timeout 0

# Replication settings
repl-diskless-sync yes
repl-diskless-sync-delay 5
repl-diskless-load on-empty-db

# Slow log
slowlog-log-slower-than 10000
slowlog-max-len 128

# Latency monitoring
latency-monitor-threshold 100
